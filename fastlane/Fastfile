fastlane_version "1.50.0"

default_platform :ios

platform :ios do

desc "Runs all the unit and ui tests"

	before_all do
     ensure_git_status_clean
  end

  desc "Runs linting (and eventually static analysis)"
  lane :analyze do
    return if test_disabled?
    make 'lint'
  end

  desc "Runs all the unit tests."
  lane :test do
    return if test_disabled?
  	cocoapods
    if is_ci
      scan(skip_slack: false)
    else
      scan
    end
  
  end

  desc "Submit new **Beta** build to Hockey app"
  lane :beta do
    sigh
    ipa(
      configuration: "Beta",
      scheme: "AdHoc",
    )
    hockey(
      notes: '',
      notify: '0', # Means do not notify
      status: '1', # Means do not make available for download
    )
    #deliver skip_deploy: true, beta: true
  end

  desc "Deploy a new version to the App Store"
  lane :store do
    snapshot
    sigh
    ipa(
      configuration: "AppStore",
      scheme: "AppStore",
    )
    hockey(
      notes: '',
      notify: '0', # Means do not notify
      status: '1', # Means do not make available for download
    )
    deliver skip_deploy: true, force: true
  end

  after_all do |lane|
  
  end

  error do |lane, exception|
  
  end
  
end